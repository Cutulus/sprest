var $REST;!function(t){var e=function(){function e(t,e){this.targetInfo=t||{},this.executeRequestFl="boolean"!=typeof e||e}return Object.defineProperty(e.prototype,"asyncFl",{get:function(){return!!this.request&&this.request.asyncFl},set:function(t){this.targetInfo.asyncFl=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.oParent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"response",{get:function(){return this.request?this.request.response:null},enumerable:!0,configurable:!0}),e.prototype.execute=function(){this.targetInfo.asyncFl||this.targetInfo.bufferFl?(this.promise=new t.Promise(this.targetInfo.callback),this.request=new t.Request(new t.TargetInfo(this.targetInfo),this.updateDataObject)):(this.request=new t.Request(new t.TargetInfo(this.targetInfo)),this.updateDataObject(this.request.response))},e.prototype.getCollection=function(t,r){var n=Object.create(this.targetInfo);n.endpoint+="/"+t,n.callback=r&&"function"==typeof r[0]?r[0]:null;var o=new e(n,(!0));return o.oParent=this,o.execute(),o},e.prototype.updateDataObject=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=t&&t.length>0?t[0]:"{}",n=JSON.parse(r);if(n.existsFl=null==n.error,n.d){this.d=n.d;for(var o in n.d){var i=n.d[o];"__metadata"!=o&&(i&&i.__deferred&&i.__deferred.uri?this["get_"+o]=new Function("return this.getCollection('"+o+"', arguments);"):this[o]=i)}}this.promise?this.promise.resolve():null},e}();t.Base=e}($REST||($REST={}));var $REST;!function(t){var e=function(){function e(e){this.promise=new t.Promise(e),this.loadDependencies()}return Object.defineProperty(e.prototype,"MAX_WAIT",{get:function(){return 5},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SCRIPTS",{get:function(){return["MicrosoftAjax.js","init.js","sp.runtime.js","sp.js","sp.core.js","core.js"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageContextExistsFl",{get:function(){return window.hasOwnProperty("_spPageContextInfo")},enumerable:!0,configurable:!0}),e.prototype.loadDependencies=function(){if(this.pageContextExistsFl)this.promise.resolve();else{for(var t in this.SCRIPTS){var e=document.createElement("script");e.setAttribute("src","/_layouts/15/"+t),e.setAttribute("type","text/javascript"),document.head.appendChild(e)}this.waitForPageContext()}},e.prototype.waitForPageContext=function(){var t=0,e=window.setInterval(function(){(this.pageContextExists()||++t>=this.MAX_WAIT)&&(window.clearInterval(e),this.promise.resolve())},10)},e}();t.Dependencies=e}($REST||($REST={}));var $REST;!function(t){var e=function(){function t(t){this.callback=t,this.resolvedFl=!1}return t.prototype.done=function(t){this.callback=t||this.callback,this.resolvedFl&&this.executeMethod()},t.prototype.resolve=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this.args=t,this.resolvedFl=!0,this.executeMethod()},t.prototype.executeMethod=function(){this.callback&&"function"==typeof this.callback&&this.callback.apply(this,this.args)},t}();t.Promise=e}($REST||($REST={}));var $REST;!function(t){var e=function(){function e(e,r){this.promise=new t.Promise(r||e.callback),this.targetInfo=e,this.xhr=this.createXHR(),this.executeRequest()}return Object.defineProperty(e.prototype,"asyncFl",{get:function(){return this.targetInfo.asyncFl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"response",{get:function(){return this.xhr?this.xhr.response:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"request",{get:function(){return this.xhr?this.xhr:null},enumerable:!0,configurable:!0}),e.prototype.createXHR=function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}throw new Error("This browser does not support xml http requests.")},e.prototype.defaultHeaders=function(){var t=document.querySelector("#__REQUESTDIGEST");if(t=t?t.value:"",this.xhr.setRequestHeader("Accept","application/json;odata=verbose"),this.xhr.setRequestHeader("Content-Type","application/json;odata=verbose"),this.xhr.setRequestHeader("X-HTTP-Method",this.targetInfo.requestMethod),this.xhr.setRequestHeader("X-RequestDigest",t),this.targetInfo.requestHeaders)for(var e in this.targetInfo.requestHeaders)this.xhr.setRequestHeader(e,this.targetInfo.requestHeaders[e])},e.prototype.executeRequest=function(){var t=this;return null==this.xhr?null:(this.xhr.open("GET"==this.targetInfo.requestMethod?"GET":"POST",this.targetInfo.requestUrl,this.targetInfo.asyncFl),this.targetInfo.asyncFl&&(this.xhr.onreadystatechange=function(){4==t.xhr.readyState&&t.promise.resolve(t.response)}),this.targetInfo.bufferFl?this.xhr.responseType="arraybuffer":(this.defaultHeaders(),this.targetInfo.requestData&&(this.targetInfo.requestData=this.targetInfo.requestData.byteLength?this.targetInfo.requestData:JSON.stringify(this.targetInfo.requestData))),void(this.targetInfo.bufferFl?this.xhr.send():this.xhr.send(this.targetInfo.requestData)))},e}();t.Request=e}($REST||($REST={}));var $REST;!function(t){var e=function(){function t(t){this.requestMethod="GET",this.targetInfo=t||{},this.targetInfo.asyncFl=!!this.targetInfo.asyncFl,this.setRequestUrl()}return Object.defineProperty(t.prototype,"asyncFl",{get:function(){return this.targetInfo.asyncFl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferFl",{get:function(){return this.targetInfo.bufferFl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"callback",{get:function(){return this.targetInfo.callback},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){return window._spPageContextInfo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAppWeb",{get:function(){return this.context.isAppWeb},enumerable:!0,configurable:!0}),t.prototype.getDomainUrl=function(){var t=document.location.href;return this.isAppWeb&&(t=this.getQueryStringValue("SPHostUrl")+""),t=t.split("/"),t&&t.length>=2&&(t=t[0]+"//"+t[2]),t},t.prototype.getQueryStringValue=function(t){var e=document.location.href.split("?");e=e.length>1?e[1]:e[0];for(var r=e.split("&"),n=0;n<r.length;n++){var o=r[n].split("=");if(1!=o.length&&decodeURIComponent(o[0])==t)return decodeURIComponent(o[1])}return null},t.prototype.setRequestUrl=function(){var t="{{Url}}/_api/{{EndPoint}}{{TargetUrl}}";if(null==this.targetInfo.url&&(this.targetInfo.url=this.context[this.targetInfo.defaultToWebFl?"webAbsoluteUrl":"siteAbsoluteUrl"]),0!=this.targetInfo.url.indexOf("http")&&(this.targetInfo.url=this.getDomainUrl()+this.targetInfo.url),this.isAppWeb){var e=this.targetInfo.endpoint.indexOf("?")>0?"&":"?";this.requestUrl=t.replace("{{Url}}",this.context.webAbsoluteUrl).replace("{{EndPoint}}",e).replace("{{TargetUrl}}","@target='"+this.targetInfo.url+"'")}else this.requestUrl=t.replace("{{Url}}",this.targetInfo.url).replace("{{EndPoint}}",this.targetInfo.endpoint).replace("{{TargetUrl}}","")},t}();t.TargetInfo=e}($REST||($REST={}));var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},$REST;!function(t){var e=function(t){function e(e,r){t.call(this,e,r),this.defaultToWebFl=!0,this.targetInfo.endpoint="web",this.executeRequestFl&&this.execute()}return __extends(e,t),e.prototype.applyTheme=function(t,e,r,n){},e.prototype.applyWebTemplate=function(){},e.prototype.deleteObject=function(){},e.prototype.doesPushNotificationSubscriberExist=function(){},e.prototype.doesUserHavePermissions=function(){},e.prototype.ensureUser=function(){},e.prototype.getAppBdcCatalog=function(){},e.prototype.getAppBdcCatalogForAppInstance=function(){},e.prototype.getAppInstanceById=function(){},e.prototype.getAppInstancesByProductId=function(){},e.prototype.getAvailableWebTemplates=function(){},e.prototype.getCatalog=function(){},e.prototype.getChanges=function(){},e.prototype.getEntity=function(){},e.prototype.getFileByServerRelativeUrl=function(){},e.prototype.getFolderByServerRelativeUrl=function(){},e.prototype.getPushNotificationSubscriber=function(){},e.prototype.getPushNotificationSubscribersByArgs=function(){},e.prototype.getPushNotificationSubscribersByUser=function(){},e.prototype.getSubwebsForCurrentUser=function(){},e.prototype.getUserById=function(){},e.prototype.getUserEffectivePermissions=function(){},e.prototype.initPropertiesFromJson=function(){},e.prototype.loadAndInstallApp=function(){},e.prototype.loadAndInstallAppInSpecifiedLocale=function(){},e.prototype.loadApp=function(){},e.prototype.mapToIcon=function(){},e.prototype.registerPushNotificationSubscriber=function(){},e.prototype.unregisterPushNotificationSubscriber=function(){},e.prototype.update=function(){},e}(t.Base);t.Web=e}($REST||($REST={}));