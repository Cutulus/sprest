var $REST;!function(e){e.Library={};var t=function(){function t(e,t){this.targetInfo=e||{},this.executeRequestFl="boolean"!=typeof t||t}return Object.defineProperty(t.prototype,"asyncFl",{get:function(){return!!this.request&&this.request.asyncFl},set:function(e){this.targetInfo.asyncFl=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.oParent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"response",{get:function(){return this.request?this.request.response:null},enumerable:!0,configurable:!0}),t.prototype.execute=function(){this.targetInfo.asyncFl||this.targetInfo.bufferFl?(this.promise=new e.Promise(this.targetInfo.callback),this.request=new e.Request(new e.TargetInfo(this.targetInfo),this.updateDataObject)):(this.request=new e.Request(new e.TargetInfo(this.targetInfo)),this.updateDataObject(this.request.response))},t.prototype.addMethods=function(t){var n=(t.__metadata&&t.__metadata.type?t.__metadata.type:this.targetInfo.endpoint).split(".");n=n[n.length-1].toLowerCase();var r=e.Library[n];if(r)for(var o in r)switch(o){case e.RequestType.Custom.toString():for(var i=0;i<r[o].length;i++){var s=r[o][i];this[s.name]=s.function}break;default:for(var i=0;i<r[o].length;i++){var a=r[o][i];this[a]=new Function("return true;")}}},t.prototype.addProperties=function(e){for(var t in e){var n=e[t];"__metadata"!=t&&"results"!=t&&(n&&n.__deferred&&n.__deferred.uri?this["get_"+t]=new Function("return this.getCollection('"+t+"', arguments);"):this[t]=n)}},t.prototype.getCollection=function(e,n){var r=Object.create(this.targetInfo);r.endpoint+="/"+e,r.callback=n&&"function"==typeof n[0]?n[0]:null;var o=new t(r,(!0));return o.oParent=this,o.execute(),o},t.prototype.updateDataCollection=function(e){e&&(this.results=e,this.existsFl=e.length>0,1==e.length&&this.addProperties(e[0]))},t.prototype.updateDataObject=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var n=e&&e.length>0?e[0]:"{}",r=JSON.parse(n);this.existsFl=null==r.error,r.d&&(this.d=r.d,this.addProperties(r.d),this.addMethods(r.d),this.updateDataCollection(r.d.results)),this.promise?this.promise.resolve():null},t}();e.Base=t}($REST||($REST={}));var $REST;!function(e){var t=function(){function t(t){this.promise=new e.Promise(t),this.loadDependencies()}return Object.defineProperty(t.prototype,"MAX_WAIT",{get:function(){return 5},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SCRIPTS",{get:function(){return["MicrosoftAjax.js","init.js","sp.runtime.js","sp.js","sp.core.js","core.js"]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageContextExistsFl",{get:function(){return window.hasOwnProperty("_spPageContextInfo")},enumerable:!0,configurable:!0}),t.prototype.loadDependencies=function(){if(this.pageContextExistsFl)this.promise.resolve();else{for(var e in this.SCRIPTS){var t=document.createElement("script");t.setAttribute("src","/_layouts/15/"+e),t.setAttribute("type","text/javascript"),document.head.appendChild(t)}this.waitForPageContext()}},t.prototype.waitForPageContext=function(){var e=0,t=window.setInterval(function(){(this.pageContextExists()||++e>=this.MAX_WAIT)&&(window.clearInterval(t),this.promise.resolve())},10)},t}();e.Dependencies=t}($REST||($REST={}));var $REST;!function(e){var t=function(){function e(e){this.callback=e,this.resolvedFl=!1}return e.prototype.done=function(e){this.callback=e||this.callback,this.resolvedFl&&this.executeMethod()},e.prototype.resolve=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];this.args=e,this.resolvedFl=!0,this.executeMethod()},e.prototype.executeMethod=function(){this.callback&&"function"==typeof this.callback&&this.callback.apply(this,this.args)},e}();e.Promise=t}($REST||($REST={}));var $REST;!function(e){!function(e){e[e.Custom=0]="Custom",e[e.Get=1]="Get",e[e.GetAppendMethodToEndPoint=2]="GetAppendMethodToEndPoint",e[e.GetBuffer=3]="GetBuffer",e[e.GetDataAsParameter=4]="GetDataAsParameter",e[e.GetDataInBody=5]="GetDataInBody",e[e.GetDataInBodyNoArgs=6]="GetDataInBodyNoArgs",e[e.Post=7]="Post",e[e.PostAppendMethodToEndPoint=8]="PostAppendMethodToEndPoint",e[e.PostDataAsParameter=9]="PostDataAsParameter",e[e.PostDataInBody=10]="PostDataInBody",e[e.PostDataInBodyNoArgs=11]="PostDataInBodyNoArgs"}(e.RequestType||(e.RequestType={}));var t=(e.RequestType,function(){function t(t,n){this.promise=new e.Promise(n||t.callback),this.targetInfo=t,this.xhr=this.createXHR(),this.executeRequest()}return Object.defineProperty(t.prototype,"asyncFl",{get:function(){return this.targetInfo.asyncFl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"response",{get:function(){return this.xhr?this.xhr.response:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"request",{get:function(){return this.xhr?this.xhr:null},enumerable:!0,configurable:!0}),t.prototype.createXHR=function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}throw new Error("This browser does not support xml http requests.")},t.prototype.defaultHeaders=function(){var e=document.querySelector("#__REQUESTDIGEST");if(e=e?e.value:"",this.xhr.setRequestHeader("Accept","application/json;odata=verbose"),this.xhr.setRequestHeader("Content-Type","application/json;odata=verbose"),this.xhr.setRequestHeader("X-HTTP-Method",this.targetInfo.requestMethod),this.xhr.setRequestHeader("X-RequestDigest",e),this.targetInfo.requestHeaders)for(var t in this.targetInfo.requestHeaders)this.xhr.setRequestHeader(t,this.targetInfo.requestHeaders[t])},t.prototype.executeRequest=function(){var e=this;return null==this.xhr?null:(this.xhr.open("GET"==this.targetInfo.requestMethod?"GET":"POST",this.targetInfo.requestUrl,this.targetInfo.asyncFl),this.targetInfo.asyncFl&&(this.xhr.onreadystatechange=function(){4==e.xhr.readyState&&e.promise.resolve(e.response)}),this.targetInfo.bufferFl?this.xhr.responseType="arraybuffer":(this.defaultHeaders(),this.targetInfo.requestData&&(this.targetInfo.requestData=this.targetInfo.requestData.byteLength?this.targetInfo.requestData:JSON.stringify(this.targetInfo.requestData))),void(this.targetInfo.bufferFl?this.xhr.send():this.xhr.send(this.targetInfo.requestData)))},t}());e.Request=t}($REST||($REST={}));var $REST;!function(e){var t=function(){function e(e){this.requestMethod="GET",this.targetInfo=e||{},this.targetInfo.asyncFl=!!this.targetInfo.asyncFl,this.setRequestUrl()}return Object.defineProperty(e.prototype,"asyncFl",{get:function(){return this.targetInfo.asyncFl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferFl",{get:function(){return this.targetInfo.bufferFl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"callback",{get:function(){return this.targetInfo.callback},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return window._spPageContextInfo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAppWeb",{get:function(){return this.context.isAppWeb},enumerable:!0,configurable:!0}),e.prototype.getDomainUrl=function(){var e=document.location.href;return this.isAppWeb&&(e=this.getQueryStringValue("SPHostUrl")+""),e=e.split("/"),e&&e.length>=2&&(e=e[0]+"//"+e[2]),e},e.prototype.getQueryStringValue=function(e){var t=document.location.href.split("?");t=t.length>1?t[1]:t[0];for(var n=t.split("&"),r=0;r<n.length;r++){var o=n[r].split("=");if(1!=o.length&&decodeURIComponent(o[0])==e)return decodeURIComponent(o[1])}return null},e.prototype.setRequestUrl=function(){var e="{{Url}}/_api/{{EndPoint}}{{TargetUrl}}";if(null==this.targetInfo.url&&(this.targetInfo.url=this.context[this.targetInfo.defaultToWebFl?"webAbsoluteUrl":"siteAbsoluteUrl"]),0!=this.targetInfo.url.indexOf("http")&&(this.targetInfo.url=this.getDomainUrl()+this.targetInfo.url),this.isAppWeb){var t=this.targetInfo.endpoint.indexOf("?")>0?"&":"?";this.requestUrl=e.replace("{{Url}}",this.context.webAbsoluteUrl).replace("{{EndPoint}}",t).replace("{{TargetUrl}}","@target='"+this.targetInfo.url+"'")}else this.requestUrl=e.replace("{{Url}}",this.targetInfo.url).replace("{{EndPoint}}",this.targetInfo.endpoint).replace("{{TargetUrl}}","")},e}();e.TargetInfo=t}($REST||($REST={}));var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},$REST;!function(e){var t=function(e){function t(t,n){e.call(this,t,n),this.defaultToWebFl=!0,this.targetInfo.endpoint="web",this.executeRequestFl&&this.execute()}return __extends(t,e),t}(e.Base);e.Web=t,e.Library.web={},e.Library.web[e.RequestType.Get]=["doesPushNotificationSubscriberExist","getAppInstanceById","getAppInstancesByProductId","getAvailableWebTemplates","getCatalog","getContextWebInformation","getCustomListTemplates","getDocumentLibraries","getFileByServerRelativeUrl","getFolderByServerRelativeUrl","getList","getPushNotificationSubscriber","getPushNotificationSubscribersByArgs","getPushNotificationSubscribersByUser","getSubwebsFilteredForCurrentUser","getUserById","getWebUrlFromPageUrl","mapsToIcon"],e.Library.web[e.RequestType.GetDataAsParameter]=["doesUserHavePermissions","getUserEffectivePermissions"],e.Library.web[e.RequestType.Post]=["applyTheme","applyWebTemplate","breakRoleInheritance","deleteObject","getAppBdcCatalog","getAppBdcCatalogForAppInstance","getEntity","registerPushNotificationSubscriber","resetRoleInheritance","unregisterPushNotificationSubscriber"],e.Library.web[e.RequestType.PostDataAsParameter]=["addCustomAction","ensureUser"],e.Library.web[e.RequestType.PostDataInBodyNoArgs]=["executeRemoteLOB","getChanges","loadAndInstallApp","loadAndInstallAppInSpecifiedLocale","loadApp","processExternalNotification"],e.Library.web[e.RequestType.Custom]=[{name:"addContentType",function:function(e){return this.executePost("contenttypes",null,e,!0,"SP.ContentType")}},{name:"addCustomAction",function:function(e){return this.executePost("usercustomactions",null,e,!0,"SP.UserCustomAction")}},{name:"addExistingContentType",function:function(e){return this.executePost("contenttypes/addAvailableContentType",e)}},{name:"addField",function:function(e){return this.executePost("fields/add",null,e,!0,"SP.Field")}},{name:"addFieldAsXml",function:function(e){return this.executePost("fields/createFieldAsXml",null,{parameters:{__metadata:{type:"SP.XmlSchemaFieldCreationInformation"},Options:window.SP.AddFieldOptions.addFieldInternalNameHint,SchemaXml:e}},!0)}},{name:"addFile",function:function(e,t){return this.executePost("rootfolder/files/add",e,t,!0)}},{name:"addList",function:function(e){return this.executePost("lists",null,e,!0,"SP.List")}},{name:"addPermission",function:function(e){return e.__metadata={type:"SP.RoleDefinition"},this.executePost("roledefinitions",null,e,!0,"SP.RoleDefinition")}},{name:"addSiteGroup",function:function(e){return this.executePost("sitegroups",null,{Title:e},!0,"SP.Group")}},{name:"addSubFolder",function:function(e){return this.executePost("rootfolder/folders/add",e)}},{name:"addWeb",function:function(e){return this.get_Webs().add(e)}},{name:"getContentType",function:function(e){return e=encodeURIComponent(e),this.executeGet("contenttypes?$filter=Name eq '"+e+"'")}},{name:"getContentTypeById",function:function(e){return this.executeGet("contenttypes/getById",e)}},{name:"getCustomAction",function:function(e){return e=encodeURIComponent(e),this.executeGet("usercustomactions?$filter=Name eq '"+e+"' or Title eq '"+e+"'")}},{name:"getField",function:function(e){return e=encodeURIComponent(e),this.executeGet("fields?$filter=Title eq '"+e+"' or InternalName eq '"+e+"' or StaticName eq '"+e+"'")}},{name:"getFieldById",function:function(e){return this.executeGet("fields/getById",e)}},{name:"getFieldByInternalName",function:function(e){return e=encodeURIComponent(e),this.executeGet("fields?$filter=InternalName eq '"+e+"'")}},{name:"getFieldByStaticName",function:function(e){return e=encodeURIComponent(e),this.executeGet("fields?$filter=StaticName eq '"+e+"'")}},{name:"getFieldByTitle",function:function(e){return e=encodeURIComponent(e),this.executeGet("fields?$filter=Title eq '"+e+"'")}},{name:"getFile",function:function(e){return e=encodeURIComponent(e),this.executeGet("rootfolder/files?$filter=Name eq '"+e+"'")}},{name:"getListById",function:function(e){return this.executeGet("lists/getById",e)}},{name:"getListByTitle",function:function(e){return this.executeGet("lists/getByTitle",e)}},{name:"getSiteGroupById",function:function(e){return this.executeGet("sitegroups/getById",e)}},{name:"getSiteGroupByName",function:function(e){return this.executeGet("sitegroups/getByName",e)}},{name:"getSubFolder",function:function(e){return e=encodeURIComponent(e),this.executeGet("rootfolder/folders?$filter=Name eq '"+e+"'")}},{name:"getUserById",function:function(e){return this.executeGet("siteusers?$filter=Id eq "+e)}},{name:"getUserByLogin",function:function(e){return this.executeGet("siteusers/getByLoginName",null,e)}},{name:"hasAccess",function:function(e){}},{name:"sendEmail",function:function(e){return e={properties:e},e.properties.__metadata={type:"SP.Utilities.EmailProperties"},this.executePost("_api/SP.Utilities.Utility.SendEmail",null,e,!0)}},{name:"update",function:function(e){return this.executePost(null,null,e,!0,"SP.Web","MERGE")}}]}($REST||($REST={}));