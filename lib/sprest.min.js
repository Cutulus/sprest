var $REST;!function(t){var e=function(){function e(e){var n=this;console.log("[Dev] Base constructor called..."),this.settings=e;new t.Dependencies(function(){n.execute(n.settings)})}return Object.defineProperty(e.prototype,"defaultUrlToWeb",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endpoint",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"response",{get:function(){return this.request?this.request.response:null},enumerable:!0,configurable:!0}),e.prototype.execute=function(e){return this.targetInfo=new t.TargetInfo(e.url,this.endpoint,this.defaultUrlToWeb),e.url=this.targetInfo.requestUrl,new t.Request(e)},e.prototype.createDataObject=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var n=null;if(t&&t.length>0){n={};for(var o in t)n[o]=t[o]}return n},e.prototype.init=function(){},e}();t.Base=e}($REST||($REST={}));var $REST;!function(t){var e=function(){function t(t){console.log("[Dev] Dependencies constructor called..."),this.callback=t,this.loadDependencies()}return Object.defineProperty(t.prototype,"isLoaded",{get:function(){return this.pageContextExistsFl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageContextExistsFl",{get:function(){return window.hasOwnProperty("_spPageContextInfo")},enumerable:!0,configurable:!0}),t.prototype.loadDependencies=function(){if(this.pageContextExistsFl)this.notifyScripts();else{for(var t in this.dependencies){var e=document.createElement("script");e.setAttribute("src","/_layouts/15/"+t),e.setAttribute("type","text/javascript"),document.head.appendChild(e)}this.waitForPageContext()}},t.prototype.notifyScripts=function(){this.pageContextExistsFl?(console.log("[Dev] Dependencies have been loaded..."),this.callback&&"function"==typeof this.callback&&this.callback.apply(this)):console.error("[SP REST] Error: Unable to load _spPageContextInfo (Page Context).")},t.prototype.waitForPageContext=function(){var t=0,e=5e3,n=window.setInterval(function(){(this.pageContextExists()||++t>=e)&&(window.clearInterval(n),this.notifyScripts())},10)},t}();t.Dependencies=e}($REST||($REST={}));var $REST;!function(t){var e=function(){function t(t){console.log("[Dev] Request constructor called..."),this.asyncFl="boolean"!=typeof t.asyncFl||t.asyncFl,this.bufferFl="boolean"==typeof t.bufferFl&&t.bufferFl,this.callback=t.callback?t.callback:null,this.requestType=t.requestType?t.requestType:0,this.requestUrl=t.url?t.url:"",this.init(t)}return Object.defineProperty(t.prototype,"response",{get:function(){return this.xhr?this.xhr.response:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"request",{get:function(){return this.xhr?this.xhr:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this.requestUrl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAsynchronous",{get:function(){return this.asyncFl||this.bufferFl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isGetMethod",{get:function(){return this.requestType<6},enumerable:!0,configurable:!0}),t.prototype.defaultHeaders=function(t){var e=document.querySelector("#__REQUESTDIGEST");if(e=e?e.value:"",this.xhr.setRequestHeader("Accept","application/json;odata=verbose"),this.xhr.setRequestHeader("Content-Type","application/json;odata=verbose"),this.xhr.setRequestHeader("X-HTTP-Method",t.method),this.xhr.setRequestHeader("X-RequestDigest",e),t.headers)for(var n in t.headers)this.xhr.setRequestHeader(n,t.headers[n])},t.prototype.executeCallback=function(){this.callback&&"function"==typeof this.callback&&this.callback.apply(this.response)},t.prototype.executeSubRequest=function(t){},t.prototype.executeRequest=function(t){var e=this;return this.xhr.open(this.isGetMethod?"GET":"POST",this.url,this.isAsynchronous),this.isAsynchronous&&(this.xhr.onreadystatechange=function(){4==e.xhr.readyState&&e.executeCallback()}),this.bufferFl?this.xhr.responseType="arraybuffer":(this.defaultHeaders(t),t.data&&(t.data=t.data.byteLength?t.data:JSON.stringify(t.data))),this.bufferFl?this.xhr.send():this.xhr.send(t.data),this.request},t.prototype.init=function(t){if("undefined"==typeof XMLHttpRequest){try{this.xhr=new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{this.xhr=new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{this.xhr=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}throw new Error("This browser does not support xml http requests.")}this.xhr=new XMLHttpRequest,this.xhr&&this.executeRequest(t)},t}();t.Request=e}($REST||($REST={}));var $REST;!function(t){var e=function(){function t(t,e,n){this.endPoint=e,this.url=t?t:this.context[n?"webAbsoluteUrl":"siteAbsoluteUrl"],0!=this.url.indexOf("http")&&(this.url=this.getDomainUrl()+this.url),this.isAppWeb?this.template=this.context.webAbsoluteUrl+"/_api/SP.AppContextSite(@target)/{{EndPoint}}"+(this.endPoint.indexOf("?")>0?"&":"?")+"@target='{{Url}}'":this.template=this.url+"/_api/{{EndPoint}}"}return Object.defineProperty(t.prototype,"requestUrl",{get:function(){return this.template.replace("{{EndPoint}}",this.endPoint).replace("{{Url}}",this.url)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){return window._spPageContextInfo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAppWeb",{get:function(){return this.context.isAppWeb},enumerable:!0,configurable:!0}),t.prototype.getDomainUrl=function(){var t=document.location.href;return this.isAppWeb&&(t=this.getQueryStringValue("SPHostUrl")+""),t=t.split("/"),t&&t.length>=2&&(t=t[0]+"//"+t[2]),t},t.prototype.getQueryStringValue=function(t){var e=document.location.href.split("?");e=e.length>1?e[1]:e[0];for(var n=e.split("&"),o=0;o<n.length;o++){var r=n[o].split("=");if(1!=r.length&&decodeURIComponent(r[0])==t)return decodeURIComponent(r[1])}return null},t}();t.TargetInfo=e}($REST||($REST={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},$REST;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),Object.defineProperty(e.prototype,"endpoint",{get:function(){return"web"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultUrlToWeb",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.applyTheme=function(t,e,n,o){},e.prototype.applyWebTemplate=function(){},e.prototype.deleteObject=function(){},e.prototype.doesPushNotificationSubscriberExist=function(){},e.prototype.doesUserHavePermissions=function(){},e.prototype.ensureUser=function(){},e.prototype.getAppBdcCatalog=function(){},e.prototype.getAppBdcCatalogForAppInstance=function(){},e.prototype.getAppInstanceById=function(){},e.prototype.getAppInstancesByProductId=function(){},e.prototype.getAvailableWebTemplates=function(){},e.prototype.getCatalog=function(){},e.prototype.getChanges=function(){},e.prototype.getEntity=function(){},e.prototype.getFileByServerRelativeUrl=function(){},e.prototype.getFolderByServerRelativeUrl=function(){},e.prototype.getPushNotificationSubscriber=function(){},e.prototype.getPushNotificationSubscribersByArgs=function(){},e.prototype.getPushNotificationSubscribersByUser=function(){},e.prototype.getSubwebsForCurrentUser=function(){},e.prototype.getUserById=function(){},e.prototype.getUserEffectivePermissions=function(){},e.prototype.initPropertiesFromJson=function(){},e.prototype.loadAndInstallApp=function(){},e.prototype.loadAndInstallAppInSpecifiedLocale=function(){},e.prototype.loadApp=function(){},e.prototype.mapToIcon=function(){},e.prototype.registerPushNotificationSubscriber=function(){},e.prototype.unregisterPushNotificationSubscriber=function(){},e.prototype.update=function(){},e}(t.Base);t.Web=e}($REST||($REST={}));